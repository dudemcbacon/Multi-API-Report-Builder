<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Receipt Import Automation - ROI Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .inputs-section,
        .results-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #dee2e6;
        }

        .section-header {
            background: #3498db;
            color: white;
            padding: 15px;
            margin: -25px -25px 20px -25px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 10px 10px 0 0;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .subsection {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .subsection h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }

        .result-item.highlight {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            font-weight: bold;
            border-left: 4px solid #1e8449;
        }

        .result-item.warning {
            border-left-color: #f39c12;
            background: #fef9e7;
        }

        .result-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .highlight .result-value {
            font-size: 1.4em;
        }

        .dashboard {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .dashboard h3 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .dashboard-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .dashboard-item h4 {
            margin-bottom: 10px;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .dashboard-value {
            font-size: 2em;
            font-weight: bold;
        }

        .small-text {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .print-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
            transition: background 0.3s ease;
        }

        .print-button:hover {
            background: #2980b9;
        }

        #fullReport {
            background: white;
            min-height: 100vh;
            padding: 20px;
        }

        .report-container {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: white;
            padding: 40px;
            max-width: 900px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .report-container h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .report-container h2 {
            color: #34495e;
            border-bottom: 2px solid #bdc3c7;
            padding-bottom: 8px;
            margin-top: 35px;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .report-container h3 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .report-container h4 {
            color: #34495e;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .report-container ul {
            margin: 15px 0;
            padding-left: 30px;
        }

        .report-container li {
            margin: 8px 0;
            line-height: 1.5;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
                background: white;
            }

            .header {
                display: none !important;
            }

            .print-button {
                display: none;
            }

            .content {
                display: block !important;
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }

            .inputs-section {
                display: none;
            }

            .results-section {
                background: white;
                border: none;
                padding: 0;
                box-shadow: none;
            }

            .section-header {
                background: white !important;
                color: #2c3e50 !important;
                font-size: 18pt;
                font-weight: bold;
                padding: 10px 0;
                margin-bottom: 15px;
                border-bottom: 2px solid #3498db;
            }

            .result-item {
                background: white !important;
                border: none;
                border-left: none !important;
                padding: 8px 0;
                margin-bottom: 5px;
                display: flex;
                justify-content: space-between;
                font-size: 11pt;
            }

            .result-item.highlight {
                background: white !important;
                color: #2c3e50 !important;
                font-weight: bold;
                border-left: none !important;
                font-size: 12pt;
                padding: 12px 0;
            }

            .result-value {
                font-weight: bold;
            }

            .dashboard {
                background: white !important;
                color: #2c3e50 !important;
                border: 1px solid #bdc3c7;
                padding: 15px;
                border-radius: 0;
                margin-top: 20px;
            }

            .dashboard h3 {
                color: #2c3e50 !important;
                font-size: 14pt;
                margin-bottom: 15px;
            }

            .dashboard-item {
                background: white !important;
                color: #2c3e50 !important;
                border: 1px solid #ecf0f1;
                padding: 10px;
            }

            .dashboard-value {
                color: #2c3e50 !important;
                font-size: 14pt;
            }

            .dashboard-item h4 {
                color: #2c3e50 !important;
                font-size: 10pt;
            }

            .small-text {
                color: #7f8c8d !important;
                font-size: 9pt;
            }

            table {
                font-size: 10pt;
            }

            table th,
            table td {
                padding: 6px !important;
            }

            #fullReport {
                display: none !important;
            }

            .report-container {
                padding: 20px;
                font-size: 12pt;
            }

            .report-container h1 {
                page-break-before: avoid;
            }

            .report-container h2,
            .report-container h3 {
                page-break-after: avoid;
            }

            @page {
                margin: 0.75in;
                size: letter;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ROI Calculator</h1>
            <p>Sales Receipt Import Automation</p>
        </div>

        <div class="content">
            <div class="inputs-section">
                <div class="section-header">📊 Input Parameters</div>

                <div class="subsection">
                    <h4>Team Configuration</h4>
                    <div class="input-group">
                        <label for="teamSize" class="tooltip"
                            data-tooltip="Number of people who will use the application">Team Size (users):</label>
                        <input type="number" id="teamSize" value="5" min="1" max="50">
                    </div>
                    <div class="input-group">
                        <label for="hourlyRate" class="tooltip"
                            data-tooltip="Loaded hourly cost including benefits and overhead">Hourly Rate ($):</label>
                        <input type="number" id="hourlyRate" value="35" min="15" max="100">
                    </div>
                </div>

                <div class="subsection">
                    <h4>Development Costs</h4>
                    <div class="input-group">
                        <label for="devMonths" class="tooltip" data-tooltip="Time to develop the solution">Development
                            Period (months):</label>
                        <input type="number" id="devMonths" value="3" min="1" max="12" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="devHoursPerWeek" class="tooltip" data-tooltip="Developer hours per week">Hours per
                            Week:</label>
                        <input type="number" id="devHoursPerWeek" value="40" min="10" max="60">
                    </div>
                    <div class="input-group">
                        <label for="devSalary" class="tooltip" data-tooltip="Annual developer salary">Developer Annual
                            Salary ($):</label>
                        <input type="number" id="devSalary" value="55000" min="30000" max="150000" step="5000">
                    </div>
                </div>

                <div class="subsection">
                    <h4>Manual Process Time (Hours/Month)</h4>
                    <div class="input-group">
                        <label for="manualExport" class="tooltip"
                            data-tooltip="Time formatting Salesforce reports">Report Formatting:</label>
                        <input type="number" id="manualExport" value="12" min="0" max="100" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="manualRecon" class="tooltip"
                            data-tooltip="Corrections including QBES items (4 hrs/month)">Data Corrections &
                            QBES:</label>
                        <input type="number" id="manualRecon" value="4" min="0" max="100" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="manualConsol" class="tooltip"
                            data-tooltip="Adding WooCommerce fees (1.5-2 hrs/week = ~7 hrs/month)">WooCommerce Fee
                            Processing:</label>
                        <input type="number" id="manualConsol" value="7" min="0" max="100" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="webstoreClearing" class="tooltip"
                            data-tooltip="Month-end webstore clearing reconciliation">Webstore Clearing
                            Reconciliation:</label>
                        <input type="number" id="webstoreClearing" value="4" min="0" max="100" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="tieOut" class="tooltip" data-tooltip="Monthly tie-out process">Tie-Out
                            Process:</label>
                        <input type="number" id="tieOut" value="4" min="0" max="100" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="shareFileOps" class="tooltip"
                            data-tooltip="Manual file saving (~15 min/save) and accessing (~10 min/access) - Est. 20 saves + 30 accesses/month">ShareFile
                            Manual Operations:</label>
                        <input type="number" id="shareFileOps" value="8.3" min="0" max="100" step="0.1">
                    </div>
                </div>

                <div class="subsection">
                    <h4>Implementation & Operational Details</h4>
                    <div class="input-group">
                        <label for="automationSetup" class="tooltip"
                            data-tooltip="One-time setup to schedule the automated process">Automation Setup Time
                            (minutes):</label>
                        <input type="number" id="automationSetup" value="5" min="1" max="60">
                        <div class="small-text" style="color: #27ae60; margin-top: 5px;">✓ Fully automated after setup -
                            no ongoing time required</div>
                    </div>
                    <div class="input-group">
                        <label for="errorsPerMonth" class="tooltip"
                            data-tooltip="Average number of errors in manual processes per month">Errors per
                            Month:</label>
                        <input type="number" id="errorsPerMonth" value="18" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label for="errorCost" class="tooltip"
                            data-tooltip="Average cost to identify and fix each error">Cost per Error ($):</label>
                        <input type="number" id="errorCost" value="100" min="10" max="1000">
                    </div>
                    <div class="input-group">
                        <label for="maintenance" class="tooltip"
                            data-tooltip="Annual maintenance and support costs">Annual Maintenance ($):</label>
                        <input type="number" id="maintenance" value="1000" min="0" max="10000">
                    </div>
                </div>

                <div class="subsection">
                    <h4>Annual Salary Increases (Years 2-5)</h4>
                    <div class="input-group">
                        <label for="teamSalaryIncrease" class="tooltip"
                            data-tooltip="Annual salary increase for team members (affects savings in years 2-5)">Team
                            Salary Increase (%):</label>
                        <input type="number" id="teamSalaryIncrease" value="3" min="0" max="10" step="0.5">
                    </div>
                    <div class="input-group">
                        <label for="devSalaryIncrease" class="tooltip"
                            data-tooltip="Annual salary increase for developers (affects maintenance costs in years 2-5)">Developer
                            Salary Increase (%):</label>
                        <input type="number" id="devSalaryIncrease" value="3" min="0" max="10" step="0.5">
                    </div>
                </div>
            </div>

            <div class="results-section">
                <div class="section-header">📈 Calculated Results</div>

                <div class="result-item">
                    <span>Hours Saved per User/Month:</span>
                    <span class="result-value" id="hoursSaved">0</span>
                </div>

                <div class="result-item">
                    <span>Monthly Labor Savings per User:</span>
                    <span class="result-value" id="monthlySavingsUser">$0</span>
                </div>

                <div class="result-item">
                    <span>Monthly Error Cost Savings:</span>
                    <span class="result-value" id="errorSavings">$0</span>
                </div>

                <div class="result-item highlight">
                    <span>Total Monthly Team Savings:</span>
                    <span class="result-value" id="monthlyTeamSavings">$0</span>
                </div>

                <div class="result-item">
                    <span>Annual Team Savings:</span>
                    <span class="result-value" id="annualSavings">$0</span>
                </div>

                <div class="result-item">
                    <span>Development Cost:</span>
                    <span class="result-value" id="developmentCost">$0</span>
                </div>

                <div class="result-item">
                    <span>Total Implementation Cost:</span>
                    <span class="result-value" id="implementationCost">$0</span>
                </div>

                <div class="result-item highlight">
                    <span>Net Year 1 Savings:</span>
                    <span class="result-value" id="netSavings">$0</span>
                </div>

                <div class="result-item" id="paybackRow">
                    <span>Payback Period:</span>
                    <span class="result-value" id="paybackPeriod">0 months</span>
                </div>

                <div class="result-item highlight">
                    <span>Year 1 ROI:</span>
                    <span class="result-value" id="roi">0%</span>
                </div>

                <button class="print-button" onclick="generateReport()">📄 Generate Full Report</button>
                <button class="print-button" onclick="window.print()">🖨️ Print Summary</button>
                <button class="print-button" onclick="printGeneratedReport()">🖨️ Print Generated Report</button>
            </div>

            <div class="results-section" style="grid-column: 1 / -1;">
                <div class="section-header">📊 5-Year Projection</div>

                <div class="result-item" style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 2px solid #3498db;">
                                <th style="text-align: left; padding: 10px;">Year</th>
                                <th style="text-align: right; padding: 10px;">Annual Savings</th>
                                <th style="text-align: right; padding: 10px;">Costs</th>
                                <th style="text-align: right; padding: 10px;">Net Benefit</th>
                                <th style="text-align: right; padding: 10px;">Cumulative Benefit</th>
                                <th style="text-align: right; padding: 10px;">ROI</th>
                            </tr>
                        </thead>
                        <tbody id="projectionTableBody">
                            <!-- Dynamically populated -->
                        </tbody>
                        <tfoot>
                            <tr style="border-top: 2px solid #3498db; font-weight: bold;">
                                <td style="padding: 10px;">Total (5 Years)</td>
                                <td style="text-align: right; padding: 10px;" id="total5YearSavings">$0</td>
                                <td style="text-align: right; padding: 10px;" id="total5YearCosts">$0</td>
                                <td style="text-align: right; padding: 10px;" id="total5YearNet">$0</td>
                                <td style="text-align: right; padding: 10px;" id="total5YearCumulative">$0</td>
                                <td style="text-align: right; padding: 10px;" id="total5YearROI">0%</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="result-item highlight" style="margin-top: 15px;">
                    <span>5-Year Total Net Benefit:</span>
                    <span class="result-value" id="fiveYearBenefit">$0</span>
                </div>
            </div>

            <div class="dashboard">
                <h3>🎯 Executive Summary</h3>
                <div class="dashboard-grid">
                    <div class="dashboard-item">
                        <h4>Monthly Impact</h4>
                        <div class="dashboard-value" id="dashMonthly">$0</div>
                        <div class="small-text">Team savings per month</div>
                    </div>
                    <div class="dashboard-item">
                        <h4>Annual Impact</h4>
                        <div class="dashboard-value" id="dashAnnual">$0</div>
                        <div class="small-text">Total annual savings</div>
                    </div>
                    <div class="dashboard-item">
                        <h4>Payback Time</h4>
                        <div class="dashboard-value" id="dashPayback">0</div>
                        <div class="small-text">Months to break even</div>
                    </div>
                    <div class="dashboard-item">
                        <h4>5-Year Total Benefit</h4>
                        <div class="dashboard-value" id="dash5Year">$0</div>
                        <div class="small-text">Net 5-year savings</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Hidden Report Section -->
    <div id="fullReport" style="display: none;">
        <div class="report-container">
            <h1>Sales Receipt Import Automation - ROI Analysis Report</h1>

            <h2>Executive Summary</h2>
            <p>The Sales Receipt Import Automation is a multi-API data integration that delivers significant ROI through
                automation of financial operations, reduction in manual data processing, and elimination of errors in
                reconciliation tasks. This customized analysis is based on your specific organizational parameters.</p>

            <div class="metrics-box">
                <h3>Key ROI Metrics</h3>
                <ul>
                    <li><strong id="reportTimeSaving">0%</strong> reduction in total processing time</li>
                    <li><strong id="reportMonthlySavings">$0</strong> monthly team savings</li>
                    <li><strong id="reportAnnualSavings">$0</strong> annual team savings</li>
                    <li><strong id="reportPayback">0</strong> month payback period</li>
                    <li><strong id="reportROI">0%</strong> Year 1 ROI</li>
                </ul>
            </div>

            <h2>Detailed ROI Analysis</h2>

            <h3>1. Time Savings Analysis</h3>
            <h4>Current Manual Process (Monthly)</h4>
            <ul>
                <li><strong>Data Export/Import:</strong> <span id="reportManualExport">0</span> hours/month × <span
                        id="reportTeamSize">0</span> users = <span id="reportTotalManualExport">0</span> team hours</li>
                <li><strong>Data Reconciliation:</strong> <span id="reportManualRecon">0</span> hours/month × <span
                        id="reportTeamSize2">0</span> users = <span id="reportTotalManualRecon">0</span> team hours</li>
                <li><strong>Multi-source Consolidation:</strong> <span id="reportManualConsol">0</span> hours/month ×
                    <span id="reportTeamSize3">0</span> users = <span id="reportTotalManualConsol">0</span> team hours
                </li>
                <li><strong>Webstore Clearing Reconciliation:</strong> <span id="reportWebstoreClearing">0</span>
                    hours/month × <span id="reportTeamSize4">0</span> users = <span
                        id="reportTotalWebstoreClearing">0</span> team hours</li>
                <li><strong>Tie-Out Process:</strong> <span id="reportTieOut">0</span> hours/month × <span
                        id="reportTeamSize5">0</span> users = <span id="reportTotalTieOut">0</span> team hours</li>
                <li><strong>ShareFile Manual Operations:</strong> <span id="reportShareFileOps">0</span> hours/month ×
                    <span id="reportTeamSize6">0</span> users = <span id="reportTotalShareFileOps">0</span> team hours
                </li>
                <li><strong>Total Manual Hours:</strong> <span id="reportTotalManualHours">0</span> hours/month</li>
            </ul>

            <h4>Automated Process</h4>
            <ul>
                <li><strong>Process Type:</strong> Fully automated scheduled workflow</li>
                <li><strong>Setup Time:</strong> <span id="reportSetupMinutes">5</span> minutes (one-time)</li>
                <li><strong>Report Formatting:</strong> Fully automated</li>
                <li><strong>Data Corrections & QBES:</strong> Fully automated</li>
                <li><strong>WooCommerce Fee Processing:</strong> Fully automated</li>
                <li><strong>Webstore Clearing Reconciliation:</strong> Fully automated</li>
                <li><strong>Tie-Out Process:</strong> Fully automated</li>
                <li><strong>ShareFile Operations:</strong> Automated with consistent naming conventions</li>
                <li><strong>Human Intervention Required:</strong> None after initial setup</li>
                <li><strong>Total Ongoing Hours:</strong> 0 hours/month</li>
            </ul>

            <h4>Time Savings Calculation</h4>
            <ul>
                <li><strong>Hours Saved Monthly:</strong> <span id="reportHoursSaved">0</span> hours</li>
                <li><strong>Hours Saved Annually:</strong> <span id="reportAnnualHoursSaved">0</span> hours</li>
                <li><strong>Time Reduction Percentage:</strong> <span id="reportTimeReduction">0%</span></li>
            </ul>

            <h3>2. Cost Savings Analysis</h3>
            <h4>Labor Cost Savings</h4>
            <ul>
                <li><strong>Hourly Rate:</strong> <span id="reportHourlyRate">$0</span></li>
                <li><strong>Monthly Labor Savings:</strong> <span id="reportMonthlyLaborSavings">$0</span></li>
                <li><strong>Annual Labor Savings:</strong> <span id="reportAnnualLaborSavings">$0</span></li>
            </ul>

            <h4>Error Reduction Value</h4>
            <ul>
                <li><strong>Current Error Rate:</strong> <span id="reportErrorsPerMonth">0</span> errors/month</li>
                <li><strong>Cost per Error:</strong> <span id="reportErrorCost">$0</span></li>
                <li><strong>Monthly Error Cost Avoided:</strong> <span id="reportMonthlyErrorSavings">$0</span></li>
                <li><strong>Annual Error Cost Avoided:</strong> <span id="reportAnnualErrorSavings">$0</span></li>
            </ul>

            <h3>3. Implementation Costs</h3>
            <h4>Development Costs</h4>
            <ul>
                <li><strong>Development Period:</strong> <span id="reportDevMonths">0</span> months</li>
                <li><strong>Developer Hours per Week:</strong> <span id="reportDevHoursPerWeek">0</span> hours</li>
                <li><strong>Total Development Hours:</strong> <span id="reportTotalDevHours">0</span> hours</li>
                <li><strong>Developer Hourly Rate:</strong> <span id="reportDevHourlyRate">$0</span></li>
                <li><strong>Total Development Cost:</strong> <span id="reportDevelopmentCost">$0</span></li>
            </ul>

            <h4>Implementation Costs</h4>
            <ul>
                <li><strong>Total Implementation Cost:</strong> <span id="reportTotalImplementation">$0</span></li>
            </ul>

            <h4>Ongoing Costs</h4>
            <ul>
                <li><strong>Annual Maintenance:</strong> <span id="reportMaintenance">$0</span></li>
                <li><strong>Monthly Maintenance:</strong> <span id="reportMonthlyMaintenance">$0</span></li>
            </ul>

            <h3>4. ROI Timeline</h3>
            <h4>Month 1</h4>
            <ul>
                <li>Implementation and training costs: <span id="reportMonth1Cost">-$0</span></li>
                <li>Partial productivity gains (50%): <span id="reportMonth1Savings">$0</span></li>
                <li><strong>Net Month 1:</strong> <span id="reportMonth1Net">$0</span></li>
            </ul>

            <h4>Months 2-12</h4>
            <ul>
                <li>Full monthly savings: <span id="reportFullMonthlySavings">$0</span></li>
                <li>Monthly ROI (after payback): <span id="reportMonthlyROI">0%</span></li>
            </ul>

            <h4>Year 1 Summary</h4>
            <ul>
                <li><strong>Total Annual Savings:</strong> <span id="reportYear1Savings">$0</span></li>
                <li><strong>Total Costs:</strong> <span id="reportYear1Costs">$0</span></li>
                <li><strong>Net Year 1 Benefit:</strong> <span id="reportYear1Net">$0</span></li>
                <li><strong>Year 1 ROI:</strong> <span id="reportYear1ROI">0%</span></li>
            </ul>

            <h2>Productivity Impact Analysis</h2>
            <h3>Staff Reallocation Benefits</h3>
            <ul>
                <li><strong>Hours freed for strategic work:</strong> <span id="reportStrategicHours">0</span>
                    hours/month</li>
                <li><strong>Value of strategic work:</strong> $50-75/hour (estimated)</li>
                <li><strong>Monthly opportunity value:</strong> <span id="reportOpportunityValue">$0</span> - <span
                        id="reportOpportunityValueHigh">$0</span></li>
            </ul>

            <h3>Scalability Benefits</h3>
            <ul>
                <li>Process 100,000+ rows automatically</li>
                <li>No additional time for 10x data volume increase</li>
                <li>Fully automated - runs unattended on schedule</li>
                <li>Supports business growth without any staff increase</li>
                <li>Eliminates all manual processing time</li>
                <li>Zero overtime costs - runs 24/7 if needed</li>
            </ul>

            <h3>ShareFile Automation Benefits</h3>
            <ul>
                <li><strong>Automated File Naming:</strong> Consistent naming conventions applied automatically</li>
                <li><strong>Automatic Upload:</strong> Reports saved directly to ShareFile without manual intervention
                </li>
                <li><strong>Version Control:</strong> Automatic versioning and audit trail</li>
                <li><strong>Time Saved:</strong> ~<span id="reportShareFileSaveTime">15</span> minutes per file save, ~<span id="reportShareFileAccessTime">10</span> minutes per file retrieval
                </li>
                <li><strong>Monthly Impact:</strong> Eliminates <span id="reportShareFileTotalHours">8.3</span> hours of manual file management</li>
                <li><strong>Error Reduction:</strong> No more misfiled or misnamed reports</li>
                <li><strong>Instant Access:</strong> Team members can access reports immediately after generation</li>
            </ul>

            <h2>Risk Mitigation</h2>
            <h3>Operational Risks Eliminated</h3>
            <ul>
                <li><strong>Manual error risk:</strong> Eliminated through automation</li>
                <li><strong>Key person dependency:</strong> Process documented and automated</li>
                <li><strong>Data loss risk:</strong> Automated backups and audit trails</li>
                <li><strong>Compliance risk:</strong> Consistent rule application</li>
            </ul>

            <h3>Financial Risk Reduction</h3>
            <ul>
                <li><strong>Revenue leakage:</strong> Caught through automated reconciliation</li>
                <li><strong>Error correction costs:</strong> Reduced by <span id="reportErrorReduction">95%</span></li>
                <li><strong>Audit findings:</strong> Significantly reduced through automated processes</li>
            </ul>

            <h2>Competitive Advantages</h2>
            <h3>Speed to Insight</h3>
            <ul>
                <li><strong>5x faster</strong> financial reporting</li>
                <li><strong>Same-day</strong> sales receipt import vs. 3-5 days</li>
                <li><strong>Real-time</strong> problem identification</li>
            </ul>

            <h3>Business Agility</h3>
            <ul>
                <li>Handle <strong>10x data volume</strong> without additional staff</li>
                <li>Support business growth without proportional cost increase</li>
                <li>Enable new business models through automation</li>
            </ul>

            <h2>5-Year Financial Projection</h2>
            <p><em>Note: Projections include <span id="reportProjectionTeamIncrease">0</span>% annual team salary
                    increases and <span id="reportProjectionDevIncrease">0</span>% annual developer salary increases
                    starting in Year 2.</em></p>
            <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                <thead>
                    <tr style="background: #ecf0f1;">
                        <th style="padding: 10px; text-align: left; border: 1px solid #bdc3c7;">Year</th>
                        <th style="padding: 10px; text-align: right; border: 1px solid #bdc3c7;">Savings</th>
                        <th style="padding: 10px; text-align: right; border: 1px solid #bdc3c7;">Costs</th>
                        <th style="padding: 10px; text-align: right; border: 1px solid #bdc3c7;">Net Benefit</th>
                        <th style="padding: 10px; text-align: right; border: 1px solid #bdc3c7;">Cumulative</th>
                        <th style="padding: 10px; text-align: right; border: 1px solid #bdc3c7;">ROI</th>
                    </tr>
                </thead>
                <tbody id="reportProjectionTable">
                    <!-- Populated by JavaScript -->
                </tbody>
            </table>

            <h2>Implementation Recommendation</h2>
            <div class="metrics-box">
                <p>Based on your specific parameters, the Sales Receipt Import Automation delivers:</p>
                <ul>
                    <li><strong>Immediate monthly savings:</strong> <span id="reportFinalMonthlySavings">$0</span>
                    </li>
                    <li><strong>Annual savings:</strong> <span id="reportFinalAnnualSavings">$0</span></li>
                    <li><strong>Payback period:</strong> <span id="reportFinalPayback">0 months</span></li>
                    <li><strong>Year 1 ROI:</strong> <span id="reportFinalROI">0%</span></li>
                </ul>
            </div>

            <h3>Investment Decision</h3>
            <p id="recommendationText">With minimal implementation costs and substantial returns, this application
                represents a high-value investment that should be prioritized for immediate deployment.</p>

            <h2>Appendix: Calculation Parameters</h2>
            <h3>Your Organization's Assumptions</h3>
            <ul>
                <li><strong>Team Size:</strong> <span id="reportAppendixTeamSize">0</span> users</li>
                <li><strong>Hourly Rate:</strong> <span id="reportAppendixHourlyRate">$0</span> (loaded cost)</li>
                <li><strong>Current Manual Hours:</strong> <span id="reportAppendixManualHours">0</span> hours/month
                    total</li>
                <li><strong>Automated Hours:</strong> <span id="reportAppendixAutoHours">0</span> hours/month total</li>
                <li><strong>Error Rate:</strong> <span id="reportAppendixErrors">0</span> errors/month @ <span
                        id="reportAppendixErrorCost">$0</span> each</li>
                <li><strong>Implementation Cost:</strong> <span id="reportAppendixImplementation">$0</span> total</li>
                <li><strong>Team Salary Increase:</strong> <span id="reportAppendixTeamIncrease">0</span>% annually
                    (Years 2-5)</li>
                <li><strong>Developer Salary Increase:</strong> <span id="reportAppendixDevIncrease">0</span>% annually
                    (Years 2-5)</li>
            </ul>

            <hr>
            <p><em>This ROI analysis is based on your specific organizational parameters entered on <span
                        id="reportDate"></span>. Actual results may vary based on implementation execution and
                    operational factors.</em></p>
        </div>
    </div>
    </div>

    <script>
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatNumber(num, decimals = 1) {
            return num.toFixed(decimals);
        }

        function formatPercentage(decimal) {
            return (decimal * 100).toFixed(0) + '%';
        }

        function calculateROI() {
            // Get input values
            const teamSize = parseFloat(document.getElementById('teamSize').value) || 0;
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;

            const manualExport = parseFloat(document.getElementById('manualExport').value) || 0;
            const manualRecon = parseFloat(document.getElementById('manualRecon').value) || 0;
            const manualConsol = parseFloat(document.getElementById('manualConsol').value) || 0;
            const webstoreClearing = parseFloat(document.getElementById('webstoreClearing').value) || 0;
            const tieOut = parseFloat(document.getElementById('tieOut').value) || 0;
            const shareFileOps = parseFloat(document.getElementById('shareFileOps').value) || 0;

            // Automation is fully automated - no ongoing time
            const autoExport = 0;
            const autoRecon = 0;
            const autoConsol = 0;
            const automationSetupMinutes = parseFloat(document.getElementById('automationSetup').value) || 5;

            const errorsPerMonth = parseFloat(document.getElementById('errorsPerMonth').value) || 0;
            const errorCost = parseFloat(document.getElementById('errorCost').value) || 0;
            const setupCost = 0; // Removed per-user setup costs
            const maintenance = parseFloat(document.getElementById('maintenance').value) || 0;

            // Development costs
            const devMonths = parseFloat(document.getElementById('devMonths').value) || 0;
            const devHoursPerWeek = parseFloat(document.getElementById('devHoursPerWeek').value) || 0;
            const devSalary = parseFloat(document.getElementById('devSalary').value) || 0;
            const devHourlyRate = devSalary / (52 * 40); // Standard 2080 hours per year
            const totalDevHours = devMonths * (devHoursPerWeek * 4.33); // 4.33 weeks per month
            const developmentCost = totalDevHours * devHourlyRate;

            // Calculate time savings - automation eliminates all manual time
            const exportSaved = manualExport;
            const reconSaved = manualRecon;
            const consolSaved = manualConsol;
            const webstoreSaved = webstoreClearing;
            const tieOutSaved = tieOut;
            const shareFileSaved = shareFileOps;
            const totalHoursSaved = manualExport + manualRecon + manualConsol + webstoreClearing + tieOut + shareFileOps; // All manual time is saved

            // Calculate cost savings
            const monthlyLaborSavingsUser = totalHoursSaved * hourlyRate;
            const monthlyLaborSavingsTeam = monthlyLaborSavingsUser * teamSize;
            const monthlyErrorSavings = errorsPerMonth * errorCost; // This is already team-wide
            const monthlyTeamSavings = monthlyLaborSavingsTeam + monthlyErrorSavings;

            // Calculate annual figures
            const annualTeamSavings = monthlyTeamSavings * 12;
            const totalImplementationCost = developmentCost;
            const netYear1Savings = annualTeamSavings - totalImplementationCost - maintenance;

            // Calculate ROI metrics
            const paybackMonths = totalImplementationCost > 0 ? totalImplementationCost / monthlyTeamSavings : 0;
            const year1ROI = totalImplementationCost > 0 ? netYear1Savings / totalImplementationCost : 0;

            // Update display
            document.getElementById('hoursSaved').textContent = formatNumber(totalHoursSaved);
            document.getElementById('monthlySavingsUser').textContent = formatCurrency(monthlyLaborSavingsUser);
            document.getElementById('errorSavings').textContent = formatCurrency(monthlyErrorSavings);
            document.getElementById('monthlyTeamSavings').textContent = formatCurrency(monthlyTeamSavings);
            document.getElementById('annualSavings').textContent = formatCurrency(annualTeamSavings);
            document.getElementById('developmentCost').textContent = formatCurrency(developmentCost);
            document.getElementById('implementationCost').textContent = formatCurrency(totalImplementationCost);
            document.getElementById('netSavings').textContent = formatCurrency(netYear1Savings);
            document.getElementById('paybackPeriod').textContent = formatNumber(paybackMonths) + ' months';
            document.getElementById('roi').textContent = formatPercentage(year1ROI);

            // Update dashboard
            document.getElementById('dashMonthly').textContent = formatCurrency(monthlyTeamSavings);
            document.getElementById('dashAnnual').textContent = formatCurrency(annualTeamSavings);
            document.getElementById('dashPayback').textContent = formatNumber(paybackMonths);

            // Get salary increase percentages
            const teamSalaryIncrease = parseFloat(document.getElementById('teamSalaryIncrease').value) || 0;
            const devSalaryIncrease = parseFloat(document.getElementById('devSalaryIncrease').value) || 0;

            // Calculate 5-year projection
            const projectionTable = document.getElementById('projectionTableBody');
            projectionTable.innerHTML = '';

            let cumulativeBenefit = 0;
            let total5YearSavings = 0;
            let total5YearCosts = 0;

            // Track adjusted rates for compound growth
            let currentTeamHourlyRate = hourlyRate;
            let currentMaintenance = maintenance;

            for (let year = 1; year <= 5; year++) {
                // Apply salary increases starting from year 2
                if (year > 1) {
                    currentTeamHourlyRate = currentTeamHourlyRate * (1 + teamSalaryIncrease / 100);
                    currentMaintenance = currentMaintenance * (1 + devSalaryIncrease / 100);
                }

                // Calculate year-specific savings with adjusted hourly rate
                const yearHoursSaved = totalHoursSaved;
                const yearLaborSavingsUser = yearHoursSaved * currentTeamHourlyRate;
                const yearLaborSavingsTeam = yearLaborSavingsUser * teamSize * 12; // Annual labor savings
                const yearErrorSavings = errorsPerMonth * errorCost * 12; // Annual error savings
                const yearSavings = yearLaborSavingsTeam + yearErrorSavings;

                // Calculate year-specific costs
                const yearCosts = year === 1 ? totalImplementationCost + maintenance : currentMaintenance;

                const netBenefit = yearSavings - yearCosts;
                cumulativeBenefit += netBenefit;
                const yearROI = totalImplementationCost > 0 ? (cumulativeBenefit / totalImplementationCost) : 0;

                total5YearSavings += yearSavings;
                total5YearCosts += yearCosts;

                const row = projectionTable.insertRow();
                row.innerHTML = `
                    <td style="padding: 10px;">Year ${year}</td>
                    <td style="text-align: right; padding: 10px;">${formatCurrency(yearSavings)}</td>
                    <td style="text-align: right; padding: 10px;">${formatCurrency(yearCosts)}</td>
                    <td style="text-align: right; padding: 10px; ${netBenefit >= 0 ? 'color: #27ae60;' : 'color: #e74c3c;'}">${formatCurrency(netBenefit)}</td>
                    <td style="text-align: right; padding: 10px; font-weight: bold; ${cumulativeBenefit >= 0 ? 'color: #27ae60;' : 'color: #e74c3c;'}">${formatCurrency(cumulativeBenefit)}</td>
                    <td style="text-align: right; padding: 10px; font-weight: bold;">${formatPercentage(yearROI)}</td>
                `;
            }

            // Update 5-year totals
            document.getElementById('total5YearSavings').textContent = formatCurrency(total5YearSavings);
            document.getElementById('total5YearCosts').textContent = formatCurrency(total5YearCosts);
            document.getElementById('total5YearNet').textContent = formatCurrency(total5YearSavings - total5YearCosts);
            document.getElementById('total5YearCumulative').textContent = formatCurrency(cumulativeBenefit);
            document.getElementById('total5YearROI').textContent = formatPercentage(totalImplementationCost > 0 ? cumulativeBenefit / totalImplementationCost : 0);
            document.getElementById('fiveYearBenefit').textContent = formatCurrency(cumulativeBenefit);
            document.getElementById('dash5Year').textContent = formatCurrency(cumulativeBenefit);

            // Color coding for payback period
            const paybackRow = document.getElementById('paybackRow');
            if (paybackMonths <= 3) {
                paybackRow.className = 'result-item highlight';
            } else if (paybackMonths <= 6) {
                paybackRow.className = 'result-item';
            } else {
                paybackRow.className = 'result-item warning';
            }
        }

        // Add event listeners to all inputs
        document.addEventListener('DOMContentLoaded', function () {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', calculateROI);
            });

            // Initial calculation
            calculateROI();
        });

        // Auto-save to localStorage
        function saveInputs() {
            const inputs = document.querySelectorAll('input[type="number"]');
            const data = {};
            inputs.forEach(input => {
                data[input.id] = input.value;
            });
            localStorage.setItem('roiCalculatorData', JSON.stringify(data));
        }

        function loadInputs() {
            const saved = localStorage.getItem('roiCalculatorData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.value = data[id];
                    }
                });
            }
        }

        // Load saved data on page load
        document.addEventListener('DOMContentLoaded', function () {
            loadInputs();
            calculateROI();

            // Save on input change
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function () {
                    calculateROI();
                    saveInputs();
                });
            });
        });

        function generateReport() {
            try {
                console.log('Generating report...');

                // Get current input values
                const teamSize = parseFloat(document.getElementById('teamSize').value) || 0;
                const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;

                const manualExport = parseFloat(document.getElementById('manualExport').value) || 0;
                const manualRecon = parseFloat(document.getElementById('manualRecon').value) || 0;
                const manualConsol = parseFloat(document.getElementById('manualConsol').value) || 0;
                const webstoreClearing = parseFloat(document.getElementById('webstoreClearing').value) || 0;
                const tieOut = parseFloat(document.getElementById('tieOut').value) || 0;
                const shareFileOps = parseFloat(document.getElementById('shareFileOps').value) || 0;

                // Automation is fully automated - no ongoing time
                const autoExport = 0;
                const autoRecon = 0;
                const autoConsol = 0;
                const automationSetupMinutes = parseFloat(document.getElementById('automationSetup').value) || 5;

                const errorsPerMonth = parseFloat(document.getElementById('errorsPerMonth').value) || 0;
                const errorCost = parseFloat(document.getElementById('errorCost').value) || 0;
                const setupCost = 0; // Removed per-user setup costs
                const maintenance = parseFloat(document.getElementById('maintenance').value) || 0;

                // Development costs
                const devMonths = parseFloat(document.getElementById('devMonths').value) || 0;
                const devHoursPerWeek = parseFloat(document.getElementById('devHoursPerWeek').value) || 0;
                const devSalary = parseFloat(document.getElementById('devSalary').value) || 0;
                const devHourlyRate = devSalary / (52 * 40); // Standard 2080 hours per year
                const totalDevHours = devMonths * (devHoursPerWeek * 4.33); // 4.33 weeks per month
                const developmentCost = totalDevHours * devHourlyRate;

                // Calculate all values
                const totalManualHours = (manualExport + manualRecon + manualConsol + webstoreClearing + tieOut + shareFileOps) * teamSize;
                const totalAutoHours = 0; // Fully automated - no ongoing time
                const hoursSavedMonthly = totalManualHours; // All manual time is saved
                const hoursSavedAnnually = hoursSavedMonthly * 12;
                const timeReductionPercent = 100; // 100% reduction - fully automated

                const monthlyLaborSavings = hoursSavedMonthly * hourlyRate;
                const annualLaborSavings = monthlyLaborSavings * 12;
                const monthlyErrorSavings = errorsPerMonth * errorCost;
                const annualErrorSavings = monthlyErrorSavings * 12;

                const monthlyTeamSavings = monthlyLaborSavings + monthlyErrorSavings;
                const annualTeamSavings = annualLaborSavings + annualErrorSavings;

                const totalImplementationCost = developmentCost;
                const netYear1Savings = annualTeamSavings - totalImplementationCost - maintenance;
                const year1ROI = totalImplementationCost > 0 ? netYear1Savings / totalImplementationCost : 0;
                const paybackMonths = totalImplementationCost > 0 ? totalImplementationCost / monthlyTeamSavings : 0;

                const monthlyMaintenance = maintenance / 12;
                const month1Savings = monthlyTeamSavings * 0.5; // 50% in first month
                const month1Net = month1Savings - totalImplementationCost;
                const monthlyROI = totalImplementationCost > 0 ? monthlyTeamSavings / totalImplementationCost : 0;

                // Get salary increase percentages for report
                const teamSalaryIncreaseRate = parseFloat(document.getElementById('teamSalaryIncrease').value) || 0;
                const devSalaryIncreaseRate = parseFloat(document.getElementById('devSalaryIncrease').value) || 0;

                const strategicHours = hoursSavedMonthly;
                const opportunityValueLow = strategicHours * 50;
                const opportunityValueHigh = strategicHours * 75;

                // Populate all report fields
                document.getElementById('reportTimeSaving').textContent = formatNumber(timeReductionPercent, 0) + '%';
                document.getElementById('reportMonthlySavings').textContent = formatCurrency(monthlyTeamSavings);
                document.getElementById('reportAnnualSavings').textContent = formatCurrency(annualTeamSavings);
                document.getElementById('reportPayback').textContent = formatNumber(paybackMonths, 1);
                document.getElementById('reportROI').textContent = formatPercentage(year1ROI);

                // Time analysis section
                document.getElementById('reportManualExport').textContent = formatNumber(manualExport, 1);
                document.getElementById('reportManualRecon').textContent = formatNumber(manualRecon, 1);
                document.getElementById('reportManualConsol').textContent = formatNumber(manualConsol, 1);
                document.getElementById('reportWebstoreClearing').textContent = formatNumber(webstoreClearing, 1);
                document.getElementById('reportTieOut').textContent = formatNumber(tieOut, 1);
                document.getElementById('reportShareFileOps').textContent = formatNumber(shareFileOps, 1);

                // Set all team size references
                const teamSizeElements = ['reportTeamSize', 'reportTeamSize2', 'reportTeamSize3', 'reportTeamSize4', 'reportTeamSize5', 'reportTeamSize6', 'reportTeamSize7'];
                teamSizeElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = teamSize.toString();
                    }
                });

                document.getElementById('reportTotalManualExport').textContent = formatNumber(manualExport * teamSize, 1);
                document.getElementById('reportTotalManualRecon').textContent = formatNumber(manualRecon * teamSize, 1);
                document.getElementById('reportTotalManualConsol').textContent = formatNumber(manualConsol * teamSize, 1);
                document.getElementById('reportTotalWebstoreClearing').textContent = formatNumber(webstoreClearing * teamSize, 1);
                document.getElementById('reportTotalTieOut').textContent = formatNumber(tieOut * teamSize, 1);
                document.getElementById('reportTotalShareFileOps').textContent = formatNumber(shareFileOps * teamSize, 1);
                document.getElementById('reportTotalManualHours').textContent = formatNumber(totalManualHours, 1);

                // Report the setup time
                document.getElementById('reportSetupMinutes').textContent = automationSetupMinutes.toString();

                document.getElementById('reportHoursSaved').textContent = formatNumber(hoursSavedMonthly, 1);
                document.getElementById('reportAnnualHoursSaved').textContent = formatNumber(hoursSavedAnnually, 1);
                document.getElementById('reportTimeReduction').textContent = formatNumber(timeReductionPercent, 0) + '%';

                // Cost analysis section
                document.getElementById('reportHourlyRate').textContent = formatCurrency(hourlyRate);
                document.getElementById('reportMonthlyLaborSavings').textContent = formatCurrency(monthlyLaborSavings);
                document.getElementById('reportAnnualLaborSavings').textContent = formatCurrency(annualLaborSavings);

                document.getElementById('reportErrorsPerMonth').textContent = errorsPerMonth.toString();
                document.getElementById('reportErrorCost').textContent = formatCurrency(errorCost);
                document.getElementById('reportMonthlyErrorSavings').textContent = formatCurrency(monthlyErrorSavings);
                document.getElementById('reportAnnualErrorSavings').textContent = formatCurrency(annualErrorSavings);

                // Development costs
                document.getElementById('reportDevMonths').textContent = formatNumber(devMonths, 1);
                document.getElementById('reportDevHoursPerWeek').textContent = formatNumber(devHoursPerWeek, 0);
                document.getElementById('reportTotalDevHours').textContent = formatNumber(totalDevHours, 0);
                document.getElementById('reportDevHourlyRate').textContent = formatCurrency(devHourlyRate);
                document.getElementById('reportDevelopmentCost').textContent = formatCurrency(developmentCost);

                // Implementation costs
                document.getElementById('reportTotalImplementation').textContent = formatCurrency(totalImplementationCost);
                document.getElementById('reportMaintenance').textContent = formatCurrency(maintenance);
                document.getElementById('reportMonthlyMaintenance').textContent = formatCurrency(monthlyMaintenance);

                // ROI Timeline
                document.getElementById('reportMonth1Cost').textContent = '-' + formatCurrency(totalImplementationCost);
                document.getElementById('reportMonth1Savings').textContent = formatCurrency(month1Savings);
                document.getElementById('reportMonth1Net').textContent = formatCurrency(month1Net);

                document.getElementById('reportFullMonthlySavings').textContent = formatCurrency(monthlyTeamSavings);
                document.getElementById('reportMonthlyROI').textContent = formatPercentage(monthlyROI);

                document.getElementById('reportYear1Savings').textContent = formatCurrency(annualTeamSavings);
                document.getElementById('reportYear1Costs').textContent = formatCurrency(totalImplementationCost + maintenance);
                document.getElementById('reportYear1Net').textContent = formatCurrency(netYear1Savings);
                document.getElementById('reportYear1ROI').textContent = formatPercentage(year1ROI);

                // Productivity impact
                document.getElementById('reportStrategicHours').textContent = formatNumber(strategicHours, 1);
                document.getElementById('reportOpportunityValue').textContent = formatCurrency(opportunityValueLow);
                document.getElementById('reportOpportunityValueHigh').textContent = formatCurrency(opportunityValueHigh);

                // ShareFile automation benefits (calculating per-operation time)
                // Assuming 20 saves and 30 accesses per month (50 total operations)
                const totalOperations = 50;
                const saveOperations = 20;
                const accessOperations = 30;
                
                // Calculate time per operation based on total ShareFile hours
                const totalMinutesPerMonth = shareFileOps * 60; // Convert hours to minutes
                const averageMinutesPerOperation = totalMinutesPerMonth / totalOperations;
                
                // Weight the operations: saves typically take longer than access
                const saveMinutes = Math.round((averageMinutesPerOperation * 1.5)); // 50% more time for saves
                const accessMinutes = Math.round((averageMinutesPerOperation * 0.67)); // Shorter time for access
                
                document.getElementById('reportShareFileSaveTime').textContent = saveMinutes.toString();
                document.getElementById('reportShareFileAccessTime').textContent = accessMinutes.toString();
                document.getElementById('reportShareFileTotalHours').textContent = formatNumber(shareFileOps, 1);

                // Final recommendations
                document.getElementById('reportFinalMonthlySavings').textContent = formatCurrency(monthlyTeamSavings);
                document.getElementById('reportFinalAnnualSavings').textContent = formatCurrency(annualTeamSavings);
                document.getElementById('reportFinalPayback').textContent = formatNumber(paybackMonths, 1) + ' months';
                document.getElementById('reportFinalROI').textContent = formatPercentage(year1ROI);

                // Appendix
                document.getElementById('reportAppendixTeamSize').textContent = teamSize.toString();
                document.getElementById('reportAppendixHourlyRate').textContent = formatCurrency(hourlyRate);
                document.getElementById('reportAppendixManualHours').textContent = formatNumber(totalManualHours, 1);
                document.getElementById('reportAppendixAutoHours').textContent = formatNumber(totalAutoHours, 1);
                document.getElementById('reportAppendixErrors').textContent = errorsPerMonth.toString();
                document.getElementById('reportAppendixErrorCost').textContent = formatCurrency(errorCost);
                document.getElementById('reportAppendixImplementation').textContent = formatCurrency(totalImplementationCost);

                // Add salary increase parameters to appendix
                document.getElementById('reportAppendixTeamIncrease').textContent = teamSalaryIncreaseRate.toString();
                document.getElementById('reportAppendixDevIncrease').textContent = devSalaryIncreaseRate.toString();

                // Add salary increase rates to projection note
                const projTeamIncrease = document.getElementById('reportProjectionTeamIncrease');
                const projDevIncrease = document.getElementById('reportProjectionDevIncrease');
                if (projTeamIncrease) projTeamIncrease.textContent = teamSalaryIncreaseRate.toString();
                if (projDevIncrease) projDevIncrease.textContent = devSalaryIncreaseRate.toString();

                // Add 5-year projection to report with salary increases
                const reportProjectionTable = document.getElementById('reportProjectionTable');
                if (reportProjectionTable) {
                    reportProjectionTable.innerHTML = '';
                    let cumBenefit = 0;
                    let total5YrSavings = 0;
                    let total5YrCosts = 0;

                    // Track adjusted rates for compound growth in report
                    let reportTeamHourlyRate = hourlyRate;
                    let reportMaintenance = maintenance;

                    for (let year = 1; year <= 5; year++) {
                        // Apply salary increases starting from year 2
                        if (year > 1) {
                            reportTeamHourlyRate = reportTeamHourlyRate * (1 + teamSalaryIncreaseRate / 100);
                            reportMaintenance = reportMaintenance * (1 + devSalaryIncreaseRate / 100);
                        }

                        // Calculate year-specific savings
                        const yearHoursSaved = totalManualHours; // All manual time is saved
                        const yearLaborSavings = yearHoursSaved * reportTeamHourlyRate * 12; // Annual labor savings
                        const yearErrorSavings = monthlyErrorSavings * 12; // Annual error savings
                        const ySavings = yearLaborSavings + yearErrorSavings;

                        // Calculate year-specific costs
                        const yCosts = year === 1 ? totalImplementationCost + maintenance : reportMaintenance;

                        const netBen = ySavings - yCosts;
                        cumBenefit += netBen;
                        const yROI = totalImplementationCost > 0 ? (cumBenefit / totalImplementationCost) : 0;

                        total5YrSavings += ySavings;
                        total5YrCosts += yCosts;

                        const row = reportProjectionTable.insertRow();
                        row.innerHTML = `
                            <td style="padding: 8px; border: 1px solid #bdc3c7;">Year ${year}</td>
                            <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7;">${formatCurrency(ySavings)}</td>
                            <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7;">${formatCurrency(yCosts)}</td>
                            <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7; ${netBen >= 0 ? 'color: #27ae60;' : 'color: #e74c3c;'}">${formatCurrency(netBen)}</td>
                            <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7; font-weight: bold;">${formatCurrency(cumBenefit)}</td>
                            <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7; font-weight: bold;">${formatPercentage(yROI)}</td>
                        `;
                    }

                    // Add total row
                    const totalRow = reportProjectionTable.insertRow();
                    totalRow.style.background = '#ecf0f1';
                    totalRow.style.fontWeight = 'bold';
                    totalRow.innerHTML = `
                        <td style="padding: 8px; border: 1px solid #bdc3c7;">5-Year Total</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7;">${formatCurrency(total5YrSavings)}</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7;">${formatCurrency(total5YrCosts)}</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7; color: #27ae60;">${formatCurrency(total5YrSavings - total5YrCosts)}</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7; color: #27ae60;">${formatCurrency(cumBenefit)}</td>
                        <td style="padding: 8px; text-align: right; border: 1px solid #bdc3c7;">${formatPercentage(cumBenefit / totalImplementationCost)}</td>
                    `;
                }

                // Set current date
                document.getElementById('reportDate').textContent = new Date().toLocaleDateString();

                // Update recommendation text based on ROI
                const recommendationElement = document.getElementById('recommendationText');
                if (year1ROI > 3.0) {
                    recommendationElement.textContent = "With exceptional ROI exceeding 300%, this application represents an outstanding investment opportunity that should be implemented immediately.";
                } else if (year1ROI > 1.0) {
                    recommendationElement.textContent = "With strong ROI exceeding 100%, this application represents a high-value investment that should be prioritized for immediate deployment.";
                } else if (year1ROI > 0.5) {
                    recommendationElement.textContent = "With positive ROI and reasonable payback period, this application represents a solid investment opportunity.";
                } else {
                    recommendationElement.textContent = "Based on current parameters, consider adjusting assumptions or exploring implementation optimizations to improve ROI.";
                }

                console.log('Populating report complete, showing report...');

                // Show the report and hide the calculator
                const container = document.querySelector('.container');
                const report = document.getElementById('fullReport');

                if (container && report) {
                    container.style.display = 'none';
                    report.style.display = 'block';
                    console.log('Report displayed successfully');
                } else {
                    console.error('Could not find container or report elements');
                }

                // Scroll to top
                window.scrollTo(0, 0);

            } catch (error) {
                console.error('Error generating report:', error);
                alert('There was an error generating the report. Please check the console for details.');
            }
        }

        // Print generated report function
        function printGeneratedReport() {
            // Always generate the report first to ensure it's up to date
            generateReport();

            // Temporarily modify print styles to show the report with professional formatting
            const style = document.createElement('style');
            style.id = 'printReportStyle';
            style.textContent = `
                @media print {
                    /* Hide calculator interface */
                    .container { display: none !important; }
                    
                    /* Show and format report */
                    #fullReport { 
                        display: block !important; 
                        background: white;
                        color: #2c3e50;
                    }
                    
                    /* Professional page setup */
                    @page {
                        margin: 1in 0.75in 1in 0.75in;
                        size: letter;
                        @bottom-center {
                            content: "Page " counter(page) " of " counter(pages);
                            font-size: 10pt;
                            color: #7f8c8d;
                        }
                        @bottom-left {
                            content: "Generated: " string(report-date);
                            font-size: 9pt;
                            color: #7f8c8d;
                        }
                        @bottom-right {
                            content: "ROI Analysis - Confidential";
                            font-size: 9pt;
                            color: #7f8c8d;
                        }
                    }
                    
                    /* Professional header styling */
                    .report-container::before {
                        content: "";
                        display: block;
                        height: 80px;
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        margin: -40px -40px 30px -40px;
                        border-radius: 0;
                    }
                    
                    /* Main container styling */
                    .report-container { 
                        display: block !important;
                        padding: 40px;
                        font-family: 'Arial', 'Helvetica', sans-serif;
                        line-height: 1.4;
                        color: #2c3e50;
                        background: white;
                        max-width: none;
                        margin: 0;
                        box-shadow: none;
                    }
                    
                    /* Professional typography hierarchy */
                    .report-container h1 {
                        font-size: 24pt;
                        font-weight: bold;
                        color: #2c3e50;
                        margin: -80px 0 30px 0;
                        padding: 25px 0 15px 0;
                        text-align: center;
                        background: transparent;
                        border: none;
                        position: relative;
                        z-index: 2;
                        color: white;
                        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
                    }
                    
                    .report-container h2 {
                        font-size: 16pt;
                        font-weight: bold;
                        color: #2c3e50;
                        margin: 25px 0 15px 0;
                        padding: 10px 0 8px 0;
                        border-bottom: 2px solid #3498db;
                        page-break-after: avoid;
                    }
                    
                    .report-container h3 {
                        font-size: 14pt;
                        font-weight: bold;
                        color: #34495e;
                        margin: 20px 0 12px 0;
                        page-break-after: avoid;
                    }
                    
                    .report-container h4 {
                        font-size: 12pt;
                        font-weight: bold;
                        color: #34495e;
                        margin: 15px 0 8px 0;
                        page-break-after: avoid;
                    }
                    
                    /* Professional paragraph styling */
                    .report-container p {
                        font-size: 11pt;
                        line-height: 1.5;
                        margin: 8px 0;
                        text-align: left;
                    }
                    
                    /* Professional list styling */
                    .report-container ul {
                        margin: 12px 0;
                        padding-left: 25px;
                    }
                    
                    .report-container li {
                        font-size: 11pt;
                        line-height: 1.4;
                        margin: 6px 0;
                        page-break-inside: avoid;
                    }
                    
                    /* Executive summary box */
                    .metrics-box {
                        background: linear-gradient(135deg, #ecf0f1 0%, #f8f9fa 100%);
                        border: 2px solid #3498db;
                        padding: 20px;
                        margin: 20px 0;
                        border-radius: 8px;
                        page-break-inside: avoid;
                    }
                    
                    .metrics-box h3 {
                        color: #2c3e50;
                        font-size: 14pt;
                        margin-bottom: 15px;
                        text-align: center;
                    }
                    
                    .metrics-box ul {
                        list-style: none;
                        padding: 0;
                        margin: 0;
                    }
                    
                    .metrics-box li {
                        background: white;
                        margin: 8px 0;
                        padding: 12px;
                        border-radius: 4px;
                        border-left: 4px solid #3498db;
                        font-size: 12pt;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }
                    
                    .metrics-box strong {
                        color: #27ae60;
                        font-size: 13pt;
                    }
                    
                    /* Professional table styling */
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin: 15px 0;
                        font-size: 10pt;
                        page-break-inside: avoid;
                    }
                    
                    table caption {
                        font-size: 12pt;
                        font-weight: bold;
                        color: #2c3e50;
                        margin-bottom: 8px;
                        text-align: left;
                    }
                    
                    th {
                        background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
                        color: white;
                        font-weight: bold;
                        padding: 12px 8px;
                        text-align: left;
                        border: 1px solid #2c3e50;
                        font-size: 11pt;
                    }
                    
                    td {
                        padding: 10px 8px;
                        border: 1px solid #bdc3c7;
                        background: white;
                        font-size: 10pt;
                    }
                    
                    tr:nth-child(even) td {
                        background: #f8f9fa;
                    }
                    
                    tr:hover td {
                        background: #ecf0f1;
                    }
                    
                    /* Numeric data alignment */
                    td[style*="text-align: right"] {
                        font-family: 'Consolas', 'Monaco', monospace;
                        font-weight: 500;
                    }
                    
                    /* Highlight positive/negative values */
                    td[style*="color: #27ae60"] {
                        background: #d5f4e6 !important;
                        font-weight: bold;
                    }
                    
                    td[style*="color: #e74c3c"] {
                        background: #fadbd8 !important;
                        font-weight: bold;
                    }
                    
                    /* Section breaks */
                    .report-container h2:not(:first-of-type) {
                        margin-top: 35px;
                        page-break-before: avoid;
                    }
                    
                    /* Professional spacing */
                    .report-container > *:not(:last-child) {
                        margin-bottom: 12px;
                    }
                    
                    /* Footer disclaimer styling */
                    .report-container hr {
                        border: none;
                        border-top: 1px solid #bdc3c7;
                        margin: 30px 0 15px 0;
                    }
                    
                    .report-container hr + p {
                        font-size: 9pt;
                        color: #7f8c8d;
                        font-style: italic;
                        text-align: center;
                        margin: 10px 0 0 0;
                    }
                    
                    /* Prevent orphans and widows */
                    h1, h2, h3, h4 {
                        orphans: 3;
                        widows: 3;
                    }
                    
                    p, li {
                        orphans: 2;
                        widows: 2;
                    }
                    
                    /* Professional number formatting */
                    .report-container span[id*="report"] {
                        font-weight: 600;
                        color: #2c3e50;
                    }
                    
                    /* Currency values styling */
                    .report-container span[id*="report"]:not([id*="Hours"]):not([id*="Months"]):not([id*="Rate"]) {
                        font-family: 'Consolas', 'Monaco', monospace;
                    }
                }
            `;
            document.head.appendChild(style);

            // Wait a moment for the report to be populated, then print
            setTimeout(() => {
                window.print();
                // Clean up the temporary style after printing
                setTimeout(() => {
                    const tempStyle = document.getElementById('printReportStyle');
                    if (tempStyle) {
                        tempStyle.remove();
                    }
                }, 1000);
            }, 100);
        }

        // Add a back button functionality
        document.addEventListener('DOMContentLoaded', function () {
            const reportSection = document.getElementById('fullReport');
            const reportContainer = document.querySelector('.report-container');

            if (reportContainer) {
                const backButton = document.createElement('button');
                backButton.className = 'print-button';
                backButton.innerHTML = '← Back to Calculator';
                backButton.style.marginBottom = '20px';
                backButton.onclick = function () {
                    console.log('Back button clicked');
                    const container = document.querySelector('.container');
                    const report = document.getElementById('fullReport');

                    if (container && report) {
                        container.style.display = 'block';
                        report.style.display = 'none';
                        window.scrollTo(0, 0);
                        console.log('Returned to calculator');
                    }
                };

                // Insert back button at the beginning of the report
                reportContainer.insertBefore(backButton, reportContainer.firstChild);
                console.log('Back button added successfully');
            } else {
                console.error('Could not find report container for back button');
            }
        });
    </script>
</body>

</html>